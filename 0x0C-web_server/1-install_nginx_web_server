#!/bin/bash

# Update the package list
sudo apt-get update

# Install nginx if not already installed
if [ ! -x "$(command -v nginx)" ]; then
    sudo apt-get install nginx -y
fi

# Check if nginx is running, and start it if not
if ! pgrep nginx > /dev/null; then
    sudo service nginx start
fi

# Configure nginx to listen on port 80
sudo sed -i 's/listen 80 default_server;/listen 80;/g' /etc/nginx/sites-available/default

# Restart nginx
sudo service nginx restart

# Create an index.html file with "Hello World!" content
echo "Hello World!" | sudo tee /var/www/html/index.html > /dev/null

# Test the nginx configuration by querying localhost
if curl -s localhost | grep -q "Hello World!"; then
    echo "Nginx is configured correctly"
else
    echo "Nginx configuration test failed"
fi
